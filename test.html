<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>업데이트된 구구단 게임</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 20px;
  }
  #question, #stats {
    margin-bottom: 20px;
  }
</style>
</head>
<body>
<div id="question"></div>
<input type="number" id="answer" placeholder="답을 입력하세요" autofocus>
<button onclick="checkAnswer()">확인</button>
<div id="result"></div>
<div id="stats"></div>

<script>
let num1, num2;

// Check localStorage for saved counts and last play date
let totalQuestions = parseInt(localStorage.getItem('totalQuestions')) || 0;
let correctAnswers = parseInt(localStorage.getItem('correctAnswers')) || 0;
let lastPlayDate = localStorage.getItem('lastPlayDate') || new Date().toLocaleDateString();

function generateQuestion() {
  num1 = Math.floor(Math.random() * 9) + 1;
  num2 = Math.floor(Math.random() * 9) + 1;
  document.getElementById('question').innerHTML = `${num1} x ${num2} = ?`;
  if (new Date().toLocaleDateString() === lastPlayDate) {
    totalQuestions++;
  } else {
    totalQuestions = 1;
    correctAnswers = 0;
    lastPlayDate = new Date().toLocaleDateString();
    localStorage.setItem('lastPlayDate', lastPlayDate);
  }
  updateStats();
}

function checkAnswer() {
  const userAnswer = document.getElementById('answer').value;
  const correctAnswer = num1 * num2;
  if (parseInt(userAnswer, 10) === correctAnswer) {
    document.getElementById('result').innerHTML = "정답입니다!";
    correctAnswers++;
  } else {
    document.getElementById('result').innerHTML = "틀렸습니다. 다시 시도해보세요.";
  }
  localStorage.setItem('totalQuestions', totalQuestions);
  localStorage.setItem('correctAnswers', correctAnswers);
  generateQuestion();
  document.getElementById('answer').value = '';
  document.getElementById('answer').focus();
}

function updateStats() {
  const accuracy = totalQuestions > 0 ? ((correctAnswers / totalQuestions) * 100).toFixed(2) : 0;
  document.getElementById('stats').innerHTML = `총 문제 수: ${totalQuestions}, 정답 수: ${correctAnswers}, 정답률: ${accuracy}%`;
}

// Initialize game with the first question and load stats
window.onload = function() {
  if (new Date().toLocaleDateString() !== lastPlayDate) {
    totalQuestions = 0;
    correctAnswers = 0;
    lastPlayDate = new Date().toLocaleDateString();
    localStorage.setItem('lastPlayDate', lastPlayDate);
    localStorage.setItem('totalQuestions', '0');
    localStorage.setItem('correctAnswers', '0');
  }
  generateQuestion();
};
</script>
</body>
</html>
